pipeline {
    agent any
    
    stages {
        // Stage 1: Checkout code
        stage('Checkout') {
            steps {
                echo 'ðŸ“¦ Checking out source code...'
                checkout scm
            }
        }
        
        // Stage 2: Setup .NET
        stage('Setup .NET') {
            steps {
                echo 'ðŸ”§ Checking .NET version...'
                bat 'dotnet --version'  // Use 'bat' for Windows!
            }
        }
        
        // Stage 3: Restore & Build
        stage('Restore & Build') {
            steps {
                echo 'ðŸ”¨ Restoring packages and building...'
                bat 'dotnet restore'
                bat 'dotnet build --configuration Release --no-restore'
            }
        }
        
        // Stage 4: Run tests (if you have tests)
        stage('Test') {
            steps {
                echo 'ðŸ§ª Running tests...'
                // This will only run if tests exist
                bat 'dotnet test --no-build --verbosity normal || echo "No tests found or tests failed"'
            }
        }
        
        // Stage 5: Success message
        stage('Success') {
            steps {
                echo 'âœ… Pipeline completed successfully!'
                // Archive the build output for download
                archiveArtifacts artifacts: '**/bin/Release/**/*.dll', fingerprint: true
            }
        }
    }
    
    post {
        always {
            echo 'ðŸ§¹ Pipeline finished.'
        }
    }
}
